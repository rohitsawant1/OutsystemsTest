/* 
 This source code (the "Generated Software") is generated by the OutSystems Platform 
 and is licensed by OutSystems (http://www.outsystems.com) to You solely for testing and evaluation 
 purposes, unless You and OutSystems have executed a specific agreement covering the use terms and 
 conditions of the Generated Software, in which case such agreement shall apply. 
*/

using OutSystems.HubEdition.Extensibility.Data;

namespace OutSystems.RuntimePublic.Db {

    /// <summary>
    /// Functions to assist on the manipulation of SQL statements members
    /// </summary>
    public sealed class SqlHelper {

        private readonly IDatabaseServices services;

        internal SqlHelper(IDatabaseServices services) {
            this.services = services;
        }

        /// <summary>
        /// Escapes an identifier so it can be used in an query.
        /// </summary>
        /// <param name="identifier">The identifier to escape.</param>
        /// <returns>The identifier escaped.</returns>
        public string EscapeIdentifier(string identifier) {
            return services.DMLService.Identifiers.EscapeIdentifier(identifier);
        }

        /// <summary>
        /// Prefixes a parameter name in order to be used as a placeholder in a query or to be used as the
        /// defacto parameter name when creating command parameters.
        /// </summary>
        /// <param name="paramName">The parameter name to prefix.</param>
        /// <returns>The prefixed parameter name.</returns>
        public string PrefixParam(string paramName) {
            return services.ExecutionService.ParameterPrefix + paramName;
        }

    }

}
