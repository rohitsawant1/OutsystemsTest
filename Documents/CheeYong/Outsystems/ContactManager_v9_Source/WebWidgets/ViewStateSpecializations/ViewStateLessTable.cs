/* 
 This source code (the "Generated Software") is generated by the OutSystems Platform 
 and is licensed by OutSystems (http://www.outsystems.com) to You solely for testing and evaluation 
 purposes, unless You and OutSystems have executed a specific agreement covering the use terms and 
 conditions of the Generated Software, in which case such agreement shall apply. 
*/

using System.Web.UI.WebControls;
using System.Web.UI;
using System.Globalization;

namespace OutSystems.HubEdition.WebWidgets.ViewStateSpecializations {
    public abstract class ViewStateLessTable : System.Web.UI.WebControls.Table {
        protected ViewStateLessTable() : base() { }
        protected override object SaveViewState() { return null; }

        protected override System.Web.UI.WebControls.Style CreateControlStyle() {
            return new RemoveBorderCollapseStyle();
        }

        public class RemoveBorderCollapseStyle : TableStyle {
            private bool rendering;

            public override int CellSpacing {
                get { return rendering ? -1 : base.CellSpacing; }
                set { base.CellSpacing = value; }
            }

            public override void AddAttributesToRender(HtmlTextWriter writer, WebControl owner) {
                try {
                    rendering = true;
                    base.AddAttributesToRender(writer, owner);
                } finally {
                    rendering = false;
                }

                int spacing = CellSpacing;
                if (spacing >= 0) {
                    writer.AddAttribute(HtmlTextWriterAttribute.Cellspacing, spacing.ToString(CultureInfo.InvariantCulture));
                }
            }
        }
    }
}
      
