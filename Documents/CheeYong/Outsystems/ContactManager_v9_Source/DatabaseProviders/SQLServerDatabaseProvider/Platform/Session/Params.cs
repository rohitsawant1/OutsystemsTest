/* 
 This source code (the "Generated Software") is generated by the OutSystems Platform 
 and is licensed by OutSystems (http://www.outsystems.com) to You solely for testing and evaluation 
 purposes, unless You and OutSystems have executed a specific agreement covering the use terms and 
 conditions of the Generated Software, in which case such agreement shall apply. 
*/

using System;
using System.Data;
using OutSystems.HubEdition.Extensibility.Data.Platform.Session;

namespace OutSystems.HubEdition.DatabaseProvider.SqlServer.Platform.Session {

    internal static class Params {

        internal static object Val(object param) {
            var p = Cast(param);
            return p.Value;
        }

        internal static bool BoolVal(object param) {
            var val = Val(param).ToString();
            return val != "0" && val.ToLower() != "false";
        }

        internal static int IntVal(object param) {
            return (int) Val(param);
        }

        internal static TimeSpan TimeSpanVal(object param) {
            return new TimeSpan(0, 0, IntVal(param));
        }

        internal static ItemState ItemStateVal(object param) {
            return (ItemState) IntVal(param);
        }

        internal static byte[] BinaryVal(object param) {
            var val = Val(param);

            if (val is System.DBNull) {
                return null;
            }

            return (byte[]) val;
        }

        internal static bool IsNull(object param) {
            return Convert.IsDBNull(Val(param));
        }

        internal static void SetVal(object param, object val) {
            var p = Cast(param);
            p.Value = val;
        }

        internal static IDbDataParameter Cast(object param) {
            return (IDbDataParameter) param;
        }
    }
}